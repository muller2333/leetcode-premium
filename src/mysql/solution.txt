2356
select teacher_id, count(distinct subject_id) cnt
from Teacher
group by teacher_id


1378
select unique_id, name
from Employees
         left join EmployeeUNI on Employees.id = EmployeeUNI.id


1445
select mid.sale_date, apple_num - orange_num diff
from (select sale_date, sold_num apple_num from Sales where fruit = 'apples') mid
         inner join
     (select sale_date, sold_num orange_num from Sales where fruit = 'oranges') mid2
     on mid2.sale_date = mid.sale_date

or

select mid5.sale_date, (apple_num - orange_num) diff
from (select ifnull(sold_num, 0) apple_num, mid4.sale_date sale_date
      from (select sale_date, sold_num from Sales where fruit = 'apples') mid3
               right join (select distinct sale_date from Sales) mid4 on mid3.sale_date = mid4.sale_date) mid5
         inner join
     (select ifnull(sold_num, 0) orange_num, mid2.sale_date sale_date
      from (select sale_date, sold_num from Sales where fruit = 'oranges') mid
               right join (select distinct sale_date from Sales) mid2 on mid.sale_date = mid2.sale_date) mid6
     on mid5.sale_date = mid6.sale_date


1683
select tweet_id
from Tweets
where length(content) > 15


1303
select size team_size, employee_id
from Employee
         inner join (select team_id, count(employee_id) size from Employee group by team_id) mid
                    on mid.team_id = Employee.team_id


1350
select id, name
from Students
where department_id not in (select id from Departments)


1571
select name warehouse_name, sum(vol) volume
from (select name, WareHouse.product_id p_id, units * ifnull(vol, 0) vol
      from WareHouse
               left join (select Width * Length * Height vol, product_id from Products) mid
                         on mid.product_id = WareHouse.product_id) mid2
group by name


2084
select *
from Orders
where order_type = 0
   or customer_id not in
      (select customer_id from Orders where order_type = 0 group by customer_id having count(order_type) >= 1)


2504
select person_id, concat(name, '(', substring(profession, 1, 1), ')') name from Person order by person_id desc


1821
select customer_id from Customers where year = 2021 and revenue > 0


2339
select Teams.team_name home_team, mid.team_name away_team
from Teams
         inner join Teams mid on Teams.team_name != mid.team_name